{"version":3,"file":"component---src-pages-thoughts-mdx-fields-slug-js-content-file-path-thoughts-analytics-engineering-snowflake-remove-weekends-from-date-range-mdx-d37f20b024f74d4b4d32.js","mappings":"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","sources":["webpack://assume-wisely-blog/./thoughts/analytics_engineering/snowflake-remove-weekends-from-date-range.mdx","webpack://assume-wisely-blog/./src/pages/thoughts/{mdx.fields__slug}.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    h3: \"h3\",\n    code: \"code\",\n    br: \"br\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(_components.p, null, \"This post has been updated with additional content and a cleaner format. You can read the updated 2023 version here:\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.a, {\n    href: \"/thoughts/snowflake-datediff-business-days\"\n  }, \"Snowflake DateDiff Business Days\"), React.createElement(_components.a, {\n    href: \"/thoughts/snowflake-datediff-business-days\"\n  }, \": How Do I Exclude Weekends?\")), \"\\n\", React.createElement(_components.h3, null, \"Original Post\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.code, null, \"select\"), React.createElement(_components.br), \"\\n\", React.createElement(_components.code, null, \"DATEDIFF('day', '2022-07-01', '2022-07-14') + 1\"), React.createElement(_components.br), \"\\n\", React.createElement(_components.code, null, \"- DATEDIFF('week', '2022-07-01', DATEADD('day', 1, '2022-07-14'))\"), React.createElement(_components.br), \"\\n\", React.createElement(_components.code, null, \"- DATEDIFF('week', '2022-07-01', '2022-07-14') as working_days\"), React.createElement(_components.br), \"\\n\", React.createElement(_components.code, null, \";\")), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.code, null, \"DATEDIFF('day', '2022-07-01', '2022-07-14') + 1\"), \"\\n\", React.createElement(_components.code, null, \"select\"), \"\\n\", React.createElement(_components.code, null, \"DATEDIFF('day', '2022-07-01', '2022-07-14') + 1\")), \"\\n\", React.createElement(_components.p, null, \"This first expression naively counts days between start and end.\\nThe +1 means the end_date is included as part of the count.\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.code, null, \"- DATEDIFF('week', '2022-07-01', DATEADD('day', 1, '2022-07-14'))\")), \"\\n\", React.createElement(_components.p, null, \"This second expression counts Saturdays.\\nSince there can never be fewer Saturdays than Sundays in a given range because\\nSnowflake starts the week on Monday and Sunday is after Saturday,\\nwe will check whether the last day in the range is a Saturday.\\nThis expression checks by calculating how many weeks there are in this range if the last day is forwarded by one day.\\nFor example, if the last day is a Friday, then it moves to Saturday, and that partial week doesn't count towards our total\\nbecause DATEDIFF('week', ...) only counts fully completed weeks.\\nHowever, if the last day is a Saturday, then it gets bumped to a Sunday, and this count will increase.\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.code, null, \"- DATEDIFF('week', '2022-07-01', '2022-07-14') as working_days\"), React.createElement(_components.br), \"\\n\", React.createElement(_components.code, null, \";\")), \"\\n\", React.createElement(_components.p, null, \"This third piece counts the number of fully completed weeks, which will be the same as the number of Sundays in that range\\n(there is one Sunday per week).\"), \"\\n\", React.createElement(_components.p, null, \"Putting all the expressions together,\\nwe subtract the Saturday count\\nand Sunday count\\nfrom the first naive count to calculate the number of weekdays elapsed in the time range.\"), \"\\n\", React.createElement(_components.p, null, \"This pattern can be adjusted to accommodate different week start days\"), \"\\n\", React.createElement(_components.h3, null, \"Resources:\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.a, {\n    href: \"/thoughts/snowflake-datediff-business-days\"\n  }, \"Snowflake DateDiff Business Days\"), \": How Do I Exclude Weekends?\", React.createElement(_components.br), \"\\n\", \"https://docs.snowflake.com/en/sql-reference/functions-date-time.html#label-calendar-weeks-weekdays\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import GATSBY_COMPILED_MDX from \"/Users/rholall/Documents/CODE/rho-lall.github.io/rho-lall.github.io/thoughts/analytics_engineering/snowflake-remove-weekends-from-date-range.mdx\";\nimport * as React from 'react';\nimport {graphql} from 'gatsby';\nimport {GatsbyImage, getImage, getSrc} from 'gatsby-plugin-image';\nimport Layout from '../../components/layout';\nimport {Helmet} from 'react-helmet';\nimport {LeadCaptureForm} from '../../funnel-0ps/index.js';\nconst apiEndpoint = 'https://y1krjhl41m.execute-api.us-east-1.amazonaws.com/prod/leads';\nconst buttonText = 'Ten cent, My two cents is free';\nconst BlogPost = ({data, children}) => {\n  const urlslug = `https://rho-lall.github.io/thoughts/${data.mdx.fields.slug}`;\n  const featureimage = getImage(data.mdx.frontmatter.hero_image);\n  const socialimage = `https://rho-lall.github.io${getSrc(data.mdx.frontmatter.hero_image)}`;\n  return React.createElement(Layout, {\n    pageTitle: data.mdx.frontmatter.title\n  }, React.createElement(Helmet, null, React.createElement(\"meta\", {\n    property: \"og:title\",\n    content: data.mdx.frontmatter.title\n  }), React.createElement(\"meta\", {\n    property: \"og:type\",\n    content: \"blog\"\n  }), React.createElement(\"meta\", {\n    property: \"og:description\",\n    content: data.mdx.frontmatter.short\n  }), React.createElement(\"meta\", {\n    property: \"og:image\",\n    content: socialimage\n  }), React.createElement(\"meta\", {\n    property: \"og:locale\",\n    content: \"en_US\"\n  }), React.createElement(\"meta\", {\n    property: \"og:url\",\n    content: urlslug\n  }), React.createElement(\"meta\", {\n    property: \"og:site_name\",\n    content: \"rho-lall.github.io\"\n  }), React.createElement(\"link\", {\n    rel: \"canonical\",\n    href: urlslug\n  }), React.createElement(\"meta\", {\n    name: \"twitter:card\",\n    content: \"summary_large_image\"\n  }), React.createElement(\"meta\", {\n    name: \"twitter:image\",\n    content: socialimage\n  }), React.createElement(\"meta\", {\n    name: \"twitter:creator\",\n    content: \"@rho_Lall\"\n  }), React.createElement(\"meta\", {\n    name: \"twitter:title\",\n    content: data.mdx.frontmatter.title\n  }), React.createElement(\"meta\", {\n    name: \"title\",\n    content: data.mdx.frontmatter.title\n  }), React.createElement(\"meta\", {\n    name: \"description\",\n    content: data.mdx.frontmatter.short\n  }), React.createElement(\"meta\", {\n    name: \"keywords\",\n    content: data.mdx.frontmatter.keywords\n  }), React.createElement(\"meta\", {\n    name: \"author\",\n    content: \"Rho Lall\"\n  })), React.createElement(GatsbyImage, {\n    image: featureimage,\n    alt: data.mdx.frontmatter.hero_alt\n  }), React.createElement(\"h1\", {\n    className: \"heading\"\n  }, data.mdx.frontmatter.title), React.createElement(\"p\", {\n    className: \"heading-posted mb-10\"\n  }, \"Posted: \", data.mdx.frontmatter.date), React.createElement(\"div\", {\n    className: \"prose prose-lg max-w-none\"\n  }, children), React.createElement(\"footer\", {\n    className: \"mt-20\"\n  }, React.createElement(\"div\", null, React.createElement(\"h2\", {\n    className: \"text-center\"\n  }, \"Don't Miss My Next Thought,\"), React.createElement(\"br\")), React.createElement(\"div\", {\n    className: \"max-w-md mx-auto\"\n  }, React.createElement(LeadCaptureForm, {\n    apiEndpoint: apiEndpoint,\n    buttonText: buttonText\n  })), React.createElement(\"p\", {\n    className: \"my-20\"\n  }, \" © \", new Date(data.mdx.frontmatter.date).getFullYear(), \" · Rho Lall\")));\n};\nexport const query = graphql`\nquery blogPost($id: String) {\n  mdx(id: {eq: $id}) {\n    frontmatter {\n      title\n      short\n      keywords\n      hero_alt\n      date(formatString: \"MMMM D, YYYY\")\n      hero_image {\n        childImageSharp {\n          gatsbyImageData\n        }\n      }\n    }\n    fields {\n      slug\n    }\n    excerpt\n  }\n}\n`;\nBlogPost\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(BlogPost, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\n"],"names":["_createMdxContent","props","_components","Object","assign","p","a","h3","code","br","_provideComponents","components","React","href","wrapper","MDXLayout","BlogPost","_ref","data","children","urlslug","mdx","fields","slug","featureimage","getImage","frontmatter","hero_image","socialimage","getSrc","Layout","pageTitle","title","Helmet","property","content","short","rel","name","keywords","GatsbyImage","image","alt","hero_alt","className","date","LeadCaptureForm","apiEndpoint","buttonText","Date","getFullYear","GatsbyMDXWrapper","GATSBY_COMPILED_MDX"],"sourceRoot":""}